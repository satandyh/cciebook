---
description: 'Цикл 16, Тема 94: QoS Pre-Classify'
---

# Лабораторная по теме

{% file src="../../.gitbook/assets/lab094.zip" caption="Начальная конфигурация" %}

1. Загрузить начальную конфигурацию всех устройств.
2. Для задания используется логическая и физическая топологии проекта.
3. На маршрутизаторах R1, R2, R3, R4, R5, R6, R7 настроить OSPF процесс 100 в Аrea 0 на следующих интерфейсах:
   1. R1- E0/1.12, Loopback 0
   2. R2-E0/1.12, E0/1.23, Loopback 0
   3. R3-E0/1.34, E0/1.23, E0/1.235, Loopback 0
   4. R4-E0/1.34, E0/1.456, E0/1.235, Loopback 0
   5. R6-E0/1.67, E0/1.456, Loopback 0
   6. R7-E0/1.67, Loopback 0
4. Настроить DMVPN Phase 3 следующим образом:
   1. Настроить маршрутизатор R7 в качестве хаба DMVPN:
      1. Настроить интерфейс Tunnel0:
         1. IP адрес — 188.1.100.7/24
         2. Аутентификация NHRP — QoS
         3. Настроить динамическую поддержку мультикаста
         4. NHRP ID — 100
         5. Источник — интерфейс Ethernet 0/1.144
         6. Режим — GRE Multipoint
         7. Ключ туннеля 10000
   2. Настроить маршрутизаторы R2, R3, R4, R6 качеcтве Spok’ов:
      1. Настроить интерфейс Tunnel0:
         1. IP адрес — использовать Overlay адрес топологии
         2. Аутентификация NHRP — QoS
         3. Настроить поддержку мультикаста, указав NMBA адрес R7
         4. NHRP ID — 100
         5. В качестве сервера NHRP указать R7
         6. Источник — интерфейс Ethernet 0/1.144
         7. Ключ туннеля 10000
5. Настроить на R2, R3, R4, R6, R7 Named EIGRP процесс 100 под названием «DMVPN» на интерфейсах Tunnel 0.
6. Настроить на R7, R8, R9, R10 Named EIGRP процесс 107 под названием «QOS\_PRECLASS» на следующих интерфейсах :
   1. R7- интерфейс E0/1.78
   2. R8, R9, R10 — все интерфейсы должны быть в процессе EIGRP
7. Настроить суммирование маршрута по-умолчанию из EIGRP процесса 107 в EIGRP процесса 100 и обратно .
8. Настроить фазу 1 IPsec на R2, R3, R4, R6, R7 следующим образом:
   1. Номер политики 10
   2. Шифрование 3 DES
   3. Хэш MD5
   4. Аутентификация PSK
   5. Diffie-Hellman 5
   6. Источником для пароля «QOS\_PRECLASS» для R7 должен служить адрес 0.0.0.0
9. Настроить фазу 2 IPsec на R2, R3, R4, R6, R7 следующим образом:
   1. Создать Transform Set под названием ESP\_AES\_SHA:
      1. в качестве протокола использовать ESP
      2. в качестве аутентификации использовать HMAC SHA1
   2. Создать IPSec Profile под названием QOS\_PRECLASS:
      1. будет использовать Transform Set под названием ESP\_AES\_SHA
10. На R2, R3, R4, R6, R7 на интерфесе Tunnel 0 применить IPSec QOS\_PRECLASS
11. На R2 настроить маршрут по-умолчанию для процесса OSPF 100 с метрикой 10
12. Настроить правила QoS на R2 следующим образом:
    1. настроить ACL под названием GRE, где разрешить трафик протокола GRE в любом направлении
    2. настроить ACL под названием ICMP, где разрешить трафик протокола ICMP в любом направлении
    3. создать Class Map под названием ICMP и заматчить ACL под названием ICMP
    4. создать Class Map под названием GRE и заматчить ACL под названием GRE
    5. создать Policy Map под названием MATCH\_ICMP\_GRE и заматчить Class Map’ы под названием GRE и ICMP
    6. применить Policy Map под названием MATCH\_ICMP\_GRE на интерфейсе E0/1.144
    7. настроить QoS Pre-Classification на интферфейсе Tunnel0 R2
13. Проверить работу QoS Pre-Classification

{% file src="../../.gitbook/assets/lab094\_answers.zip" caption="Конечная конфигурация" %}

