---
description: 'Цикл 22, Тема 127: MPLS'
---

# Лабораторная по теме 127

{% file src="../../.gitbook/assets/lab127.zip" caption="Начальная конфигурация" %}

1. Загрузить начальную конфигурацию всех устройств.
2. Для задания используется логическая и физическая топологии проекта.
3. На маршрутизаторах R1, R2 настроить OSPF процесс 1289 в Аrea 0 на следующих интерфейсах:
   1. R1 — E0/1.12, Loopback0, Router ID — 180.1.1.1
   2. R2- E0/1.12, E0/1.23, Loopback0 — Router ID — 180.1.2.2
   3. Network point-to-point
4. На маршрутизаторе R3 настроить OSPF процесс 1289 следующим образом:
   1. Наименование VRF — GREEN:
   2. Router ID — 3.3.2.2
   3. Интерфейс- E0/1.23
   4. Редистрибьютить BGP процесс 73
   5. Network point-to-point
5. На маршрутизаторе R3 настроить OSPF процесс 57 следующим образом:
   1. Наименование VRF — BLUE:
   2. Router ID — 3.3.5.5
   3. Интерфейс- E0/1.235
   4. Редистрибьютить BGP процесс 73
6. На маршрутизаторе R5 настроить OSPF процесс 57 в Аrea 0, на следующих интерфейсах:
   1. R5- E0/1.235, Loopback0, Router ID — 180.1.5.5
7. На маршрутизаторах R3, R4, R6, R7 настроить OSPF процесс 37 в Аrea 0, на следующих интерфейсах:
   1. R3- E0/1.34, Loopback0, Router ID — 180.1.3.3
   2. R4- E0/1.34, E0/1.456, Loopback0 , Router ID — 180.1.4.4
   3. R6 — E0/1.67, E0/1.456, Loopback0, Router ID — 180.1.5.5
   4. R7 — E0/1.67, Loopback0, Router ID — 180.1.7.7
8. На маршрутизаторах R7, R8, R9, R10 настроить OSPF процесс 1289 в Аrea 0 на следующих интерфейсах:
   1. R8- E0/1.89, Loopback0, Router ID -180.1.8.8
   2. R9- E0/1.89, Multilink1, Loopback0, Router ID -180.1.9.9
   3. R10- Multilink1, Loopback0, Router ID -180.1.10.10
9. На маршрутизаторе R7 настроить OSPF процесс 1289 следующим образом:
   1. Наименование VRF — GREEN:
   2. Router ID — 7.7.8.8
   3. Интерфейс- E0/1.78
   4. Редистрибьютить BGP процесс 73
10. На маршрутизаторе R7 настроить OSPF процесс 57 следующим образом:
    1. Наименование VRF — BLUE:
    2. Router ID — 7.7.7.7
    3. Интерфейс- E0/1.7
    4. Редистрибьютить BGP процесс 73
11. На маршрутизаторе R3 настроить BGP процесс следующим образом:
    1. Номер AS — 73
    2. Создать внутренюю bgp сессию следующим образом:
       1. Создать BGP Peer Group:
          1. Название IBGP
          2. Указать в качестве Update Source интерфейс Loopback0
          3. В качестве соседа указать IP адрес Loopback интерфейса маршрутизатора R7
          4. Настроить марщрутизатор таким образом, чтобы он менял атрибут BGP NEXT\_HOP на свой собственный Loopback адрес.
       2. Настроить VPN следующим образом:
          1. Настроить Address Family VPNv4
          2. Активировать соседа R7
          3. Испольховать Extended Community
       3. Настроить VRF BLUE следующим образом:
          1. Настроить Address Family VPNv4 VRF BLUE
          2. Редистрибьютить OSPF процесс 57
       4. Настроить VRF GREEN следующим образом:
          1. Настроить Address Family VPNv4 VRF GREEN
          2. Редистрибьютить OSPF процесс 1289
12. На маршрутизаторе R7 настроить BGP процесс следующим образом:
    1. Номер AS — 73
    2. Создать внутренюю bgp сессию следующим образом:
       1. Создать BGP Peer Group:
          1. Название IBGP
          2. Настроить марщрутизатор таким образом, чтобы он менял атрибут BGP NEXT\_HOP на свой собственный Loopback адрес.
       2. Указать в качестве Update Source интерфейс Loopback0
       3. В качестве соседей указать IP адрес Loopback0 интерфейса маршрутизатора R3
          1. Настроить VPN следующим образом:
             1. Настроить Address Family VPNv4
             2. Активировать соседа R3
             3. Испольховать Extended Community
       4. Настроить VRF BLUE следующим образом:
          1. Настроить Address Family VPNv4 VRF BLUE
          2. Редистрибьютить OSPF процесс 57
       5. Настроить VRF GREEN следующим образом:
          1. Настроить Address Family VPNv4 VRF GREEN
          2. Редистрибьютить OSPF процесс 1289
13. Настроить MPLS на маршрутизаторах R3, R4, R6, R7 следующим образом:
    1. Настроить MPLS глобально на всех маршрутизаторах
    2. На маршрутизаторе R3:
       1. Ограничить диапазон MPLS заголовков от 300 до 399
       2. Настроить интерфейсы E0/1.34 таким образом, чтобы они принимали участие в MPLS Label Switching
    3. На маршрутизаторе R4:
       1. Ограничить диапазон MPLS заголовков от 400 до 499
       2. Настроить интерфейсы E0/1.34, E0/1.456 таким образом, чтобы они принимали участие в MPLS Label Switching
    4. На маршрутизаторе R6:
       1. Ограничить диапазон MPLS заголовков от 600 до 699
       2. Настроить интерфейсы E0/1.67, E0/1.456 таким образом, чтобы они принимали участие в MPLS Label Switching
    5. На маршрутизаторе R7:
       1. Ограничить диапазон MPLS заголовков от 700 до 799
       2. Настроить интерфейсы E0/1.67 таким образом, чтобы они принимали участие в MPLS Label Switching
14. На маршрутизаторах R3 и R7 настроить VRF следующим образом:
    1. Настроить VRF под названием BLUE
       1. Route Distinguisher 1:1
       2. Route Target \(Export/Import\) 1:1
       3. На R3 применить на интерфейсе E0/1.235
       4. На R7 применить на интерфейсе E0/1.7
    2. Настроить VRF под названием GREEN
       1. Route Distinguisher 2:2
       2. Route Target \(Export/Import\) 2:2
       3. На R3 применить на интерфейсе E0/1.23
       4. На R7 применить на интерфейсе E0/1.78

