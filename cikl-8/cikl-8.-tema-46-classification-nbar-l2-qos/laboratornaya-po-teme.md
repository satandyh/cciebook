---
description: 'Цикл 8. Тема 46: Classification NBAR, L2 QoS*'
---

# Лабораторная по теме

{% file src="../../.gitbook/assets/lab046.zip" caption="Начальная конфигурация" %}

1. Загрузить начальную конфигурацию всех устройств.
2. Для задания используется логическая и физическая топологии проекта.
3. На R1 настроить полисер следующим образом:
   1. Настроить class map c наименованием Youtube с соответствием NBAR для протокола Youtube
   2. Настроить class map c наименованием Skype с соответствием NBAR для протокола Skype
   3. Настроить policy map c наименованием Youtube\_Skype и следующими настройками:
   4. Ограничить пропускную способностью трафика youtube 1.5 Mbit/sec, TC должен быть 40 мс. Кроме того, можно дополнительно пропускать 1000 байт за интервал, но траффик должен быть перекрашен в dscp 0. Всё, что свыше этого лимита — дропать.
   5. Запретить использование Skype
   6. UPD: Применить на e0/1.12 во входящем направлении
4. На R10 настроить MQC следующим образом:
   1. class map HTTP:
      1. Примерно раз в минуту на роутер приходит 2 разных GET запроса.
      2. Используя NBAR составить одно \(!\) регулярное выражение, которое будет распознавать запрашиваемые имена файлов \(веб-страниц\) в GET запросах.
      3. Длина регулярного выражения должна быть меньше 20 символов, не считая кавычек.
      4. Имя файла может находиться, где угодно в URL.
      5. Замечание:
         1. В решении экспертов, счетчик для этого класса растет со скоростью примерно ~8-12 пакетов в минуту.
         2. Embedded Packet Capture может пригодиться
   2. class map ICMP:
      1. Должен распознавать любой ICMP траффик, не используя NBAR.
      2. При этом длина IP пакета должна быть не менее 500 байт и не более 1000 байт.
   3. Настроить policy-map QoS, где траффик класса HTTP будет дропаться, а для класса ICMP будет использован policer с CIR 8 kbps.
   4. Применить на multilink1
5. На R10 дропать все IP пакеты с опциями. Нельзя использовать MQC/ACL.

При необходимости использовать extended ACL, нужно использовать нумерованный ACL, где номер ACL равен RIP holddown timer.  
  


{% file src="../../.gitbook/assets/lab046\_answers.zip" caption="Конечная конфигурация" %}

